---
- name: Get ZFS Dataset Lists
  command: zfs list
  register: zfs_dataset_lists
  when:
    - full_uninstall
    - group_names == ['mongoc'] or group_names == ['mongod']
    - zfs_backend

- name: Remove ZFS Dataset for MongoDB
  command: zfs destroy -fR {{ zfs_pool_name }}/mongodb
  when:
    - full_uninstall
    - group_names == ['mongoc'] or group_names == ['mongod']
    - zfs_backend
    - zfs_dataset_lists.stdout.find(zfs_pool_name ~ "/mongodb") != -1
